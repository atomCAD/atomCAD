MOL (MDL) V3000 — minimal exporter spec (atoms with element+position, bonds with multiplicity)

Short and exact so your coding assistant can implement a minimal V3000 writer. Everything not required by you may be filled with zeros/blanks. Focus: explicit atom indices, coordinates, element symbol, and explicit bond lines with multiplicity.

File skeleton (record order)

Header: 3 lines (title, program/version, comment).

A normal counts line (the legacy counts-line used in V2000) — include the token V3000 somewhere on this line. Readers will usually pay attention to the M V30 block below; exact placement of V3000 in the header counts line can follow common practice (right side).

CTAB block using M V30 ... tokens (this is the authoritative structure for V3000):

M  V30 BEGIN CTAB
M  V30 COUNTS {nat} {nb} 0 0 0
M  V30 BEGIN ATOM
M  V30 <atom-lines...>
M  V30 END ATOM
M  V30 BEGIN BOND
M  V30 <bond-lines...>
M  V30 END BOND
M  V30 END CTAB
M  END


(For SDF multi-record files) after M END use $$$$ to separate records.

Note: the COUNTS line inside the M V30 block is authoritative — the header counts line is only legacy/compatibility.

M V30 COUNTS line

Format (token-separated):
M V30 COUNTS {nat} {nb} 0 0 0

{nat} = number of atoms (integer, no fixed-width limit)

{nb} = number of bonds (integer)

remaining three fields may be 0 for our minimal exporter.

Example:

M  V30 COUNTS 1234 567 0 0 0

Atom lines (inside M V30 BEGIN ATOM / END ATOM)

One tokenized line per atom, 1-based index required.

Minimal required tokens:
M V30 <idx> <Element> <x> <y> <z> [0]

<idx>: atom index (integer, 1-based)

<Element>: element symbol, correct capitalization (C, Cl, H, Fe, …)

<x> <y> <z>: coordinates as decimal text (space-separated). Use a reasonable numeric format (e.g. decimal with 4–6 fractional digits or full double-precision text). No fixed-column formatting required.

Trailing token: many examples include a final 0 or 0 flags — include a 0 if you want to be conservative.

Example atom lines:

M  V30 1 C 0.0000 0.0000 0.0000 0
M  V30 2 O 1.2245 0.0000 0.0000 0
M  V30 3 H -0.6123 0.8892 0.0000 0


Guidelines:

Keep tokens separated by single spaces.

No fixed-width columns are required inside M V30 atom lines.

Use 1-based indexing; indexes must be unique and contiguous (typical practice).

Bond lines (inside M V30 BEGIN BOND / END BOND)

One tokenized line per bond, 1-based bond index.

Minimal required tokens:
M V30 <bidx> <btype> <a1> <a2> [props]

<bidx>: bond index (integer, 1-based)

<btype>: bond type / multiplicity (int): use 1=single, 2=double, 3=triple, 4=aromatic (use your multiplicity mapping)

<a1>, <a2>: atom indices the bond connects (1-based)

optional extra tokens can be 0 or omitted for minimal exporter

Example bond lines:

M  V30 1 1 1 2
M  V30 2 1 1 3


Guidelines:

Keep bond index sequence matching your bond list order (1..nb).

Use the multiplicity you have in atomCAD directly as <btype>.

Termination

End the CTAB with:

M  V30 END CTAB
M  END


For SDF: after M END add any data fields you want, then a separator line:

$$$$

Minimal full-file example (ethane-like, 2 C, 6 H; simplified)
Ethane
atomCAD 1.0
Generated by atomCAD
  0  0  0  0  0  0            999 V3000
M  V30 BEGIN CTAB
M  V30 COUNTS 8 7 0 0 0
M  V30 BEGIN ATOM
M  V30 1 C 0.000000 0.000000 0.000000 0
M  V30 2 C 1.530000 0.000000 0.000000 0
M  V30 3 H -0.540000 0.935000 0.000000 0
M  V30 4 H -0.540000 -0.935000 0.000000 0
M  V30 5 H 0.000000 0.000000 1.090000 0
M  V30 6 H 2.070000 0.935000 0.000000 0
M  V30 7 H 2.070000 -0.935000 0.000000 0
M  V30 8 H 1.530000 0.000000 -1.090000 0
M  V30 END ATOM
M  V30 BEGIN BOND
M  V30 1 1 1 2
M  V30 2 1 1 3
M  V30 3 1 1 4
M  V30 4 1 1 5
M  V30 5 1 2 6
M  V30 6 1 2 7
M  V30 7 1 2 8
M  V30 END BOND
M  V30 END CTAB
M  END

Implementation checklist for your coding assistant

 Write three header lines (name, program/version, comment).

 Write a header counts-line that contains the token V3000 (position not critical). Readers will check M V30 blocks.

 Emit CTAB as shown: BEGIN CTAB, COUNTS {nat} {nb} 0 0 0.

 Emit BEGIN ATOM block: for each atom i (1..nat) write M V30 i Element x y z 0. Use 1-based index. Coordinates as plain decimal strings.

 Emit BEGIN BOND block: for each bond j (1..nb) write M V30 j <btype> a1 a2. Use 1-based atom indices and 1-based bond indices.

 Emit M V30 END CTAB and M END. For SDF add $$$$ after each record.

 If you later need extra fields (charges, isotopes, stereo), add them as token key/values on the atom/bond lines per the full CTfile spec — but you can ignore them now.

Notes & tips

V3000 is tokenized — no fixed-column parsing is required inside M V30 blocks. That makes writing easier than fixed-width V2000 in many cases.

Indices are 1-based everywhere.

There is no 999-atom limit in V3000; COUNTS accepts arbitrary integers.

Use consistent numeric formatting (e.g., "{:.6f}") so output is readable and stable.

Keep element capitalization standard (Cl, not CL).